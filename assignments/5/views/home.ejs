<%- include('./partials/header') %>


<main>
  <div class="container home-container">

    <!-- Featured Movie -->
    <section class="section featured-section">
      <h1 class="search-bar">Search For Your Favorite Movies</h1>
      <form action="/search" method="GET">
              <input
                type="text"
                name="q"
                placeholder="Search for a movie..."
                aria-label="Search for a movie"
                required>
            </form>
      </section>

    <!-- Trending -->
    <section class="section">
      <h2>Trending Now</h2>
      <p">Based on reviews from the last 7 days</p>

      <div class="movie-grid">
        <% if (trendingMovies && trendingMovies.length) { %>
          <% trendingMovies.forEach(movie => { %>
            <article id="movie-card">
              <a href="/movies/<%= movie.id %>" class="movie-poster-link">
                <% if (movie.image) { %>
                  <img src="<%= movie.image %>" alt="<%= movie.title %> poster" class="movie-poster">
                <% } else { %>
                  <p>No Poster Found</p>
                <% } %>
              </a>

              <div class="movie-meta">
                <h3>
                  <a href="/movies/<%= movie.id %>"><%= movie.title %></a>
                </h3>
                <p class="movie-sub">
                  <span><%= movie.year || 'N/A' %></span>
                  <span>‚Ä¢</span>
                  <span><%= movie.rating || 'NR' %></span>
                </p>
                <p class="movie-extra">
                  üî• <%= movie.review_count_week %> reviews this week
                </p>
                <span class="movie-pill">Movie</span>
              </div>
            </article>
          <% }) %>
        <% } else { %>
          <p>No trending movies in the last week.</p>
        <% } %>
      </div>
    </section>

    <!-- Popular -->
    <section class="section">
      <h2 class="section-title">Popular Movies</h2>
      <p class="section-subtitle">Most reviewed movies of all time</p>

      <div class="movie-grid">
        <% if (popularMovies && popularMovies.length) { %>
          <% popularMovies.forEach(movie => { %>
            <article class="movie-card">
              <a href="/movies/<%= movie.id %>" class="movie-poster-link">

                <% if (movie.image) { %>
                  <img src="<%= movie.image %>" alt="<%= movie.title %> poster" class="movie-poster">
                <% } else { %>
                  <div class="movie-poster placeholder">No Image</div>
                <% } %>
              </a>

              <div class="movie-meta">
                <h3 class="movie-title">
                  <a href="/movies/<%= movie.id %>"><%= movie.title %></a>
                </h3>
                <p class="movie-sub">
                  <span><%= movie.year || 'N/A' %></span>
                  <span>‚Ä¢</span>
                  <span><%= movie.rating || 'NR' %></span>
                </p>
                <p class="movie-extra">
                  ‚≠ê <%= movie.review_count_all || 0 %> total reviews
                </p>
                <span class="movie-pill">Movie</span>
              </div>
            </article>
          <% }) %>
        <% } else { %>
          <p>No popular movies yet.</p>
        <% } %>
      </div>
    </section>

  </div>
</main>

<%- include('./partials/footer') %>
